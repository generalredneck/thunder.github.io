import{r as t,o as i,c as d,a as e,b as n,w as u,F as l,e as a,d as o}from"./app.e4b5da82.js";import{_ as p}from"./plugin-vue_export-helper.21dcd24c.js";const c={},h=e("h1",{id:"update-thunder-2-thunder-3",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#update-thunder-2-thunder-3","aria-hidden":"true"},"#"),a(" Update Thunder 2 -> Thunder 3")],-1),m=e("h2",{id:"prerequisites",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#prerequisites","aria-hidden":"true"},"#"),a(" Prerequisites")],-1),b=a("These are the instructions to manually update your existing Thunder 2 installation to Thunder 3. If you want to do a fresh installation of thunder please visit "),g=a("install Thunder"),f=a(". The most significant change is the migration to media in core. But we also made some changes to our composer.json."),v=o(`<p>You have to make sure, that your Thunder 2 project and all it&#39;s dependecies, are fully updated to the most current versions. Run the following command in your docroot:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>drush ev <span class="token string">&quot;print drupal_get_installed_schema_version(&#39;thunder&#39;) . PHP_EOL;&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This should print the number 8138 or greater. If that is not the case, update your project.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">composer</span> update
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This should update to Thunder 8.2.47 or greater.</p><p>Now run database updates:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> docroot
drush updb
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>You should at least see the thunder 8138 schema update. If not, double check that the correct version of Thunder is installed, and that <code>drush updb</code> did not throw any errors.</p><h2 id="composer-adjustments" tabindex="-1"><a class="header-anchor" href="#composer-adjustments" aria-hidden="true">#</a> Composer adjustments</h2><p>We switched from bower-asset to npm-asset for our frontend-libraries. In order to get the libraries downloaded to the correct location, please replace</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;installer-types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;bower-asset&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>by</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;installer-types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;bower-asset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;npm-asset&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>in the composer.json of your project and add &quot;type:npm-asset&quot; to the &quot;docroot/libraries/{$name}&quot; section in installer-paths.</p><p>We moved the composer package under the thunder namespace, so remove the old package and a the new one.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> remove burdamagazinorg/thunder
<span class="token function">composer</span> require <span class="token string">&quot;thunder/thunder-distribution:~3.3&quot;</span> --no-update
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>You have to update composer now.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> update
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We removed some modules from our codebase. In case you are using one of below mentioned modules please require them manually for your project.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> require drupal/views_load_more --no-update
<span class="token function">composer</span> require drupal/breakpoint_js_settings --no-update
<span class="token function">composer</span> require valiton/harbourmaster --no-update
<span class="token function">composer</span> require drupal/riddle_marketplace:~3.0 --no-update
<span class="token function">composer</span> require drupal/nexx_integration:~3.0 --no-update
<span class="token function">composer</span> require burdamagazinorg/infinite_module:~1.0 --no-update
<span class="token function">composer</span> require burdamagazinorg/infinite_theme:~1.0 --no-update
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="update-facebook-instant-articles-integration" tabindex="-1"><a class="header-anchor" href="#update-facebook-instant-articles-integration" aria-hidden="true">#</a> Update Facebook instant articles integration</h2><p>In case you are using the fb_instant_articles module, please note that the RSS feed url will change and therefore needs to be updated in the facebook account.</p><p>When updating while fb_instant_articles is enabled, there will be an error message like <code>The &quot;fiafields&quot; plugin does not exist. Valid plugin IDs for Drupal\\views\\Plugin\\ViewsPluginManager are: ...</code> this is due to invalid configuration present in the system before the update and can safely be ignored.</p><h2 id="pre-requirements-for-media-update" tabindex="-1"><a class="header-anchor" href="#pre-requirements-for-media-update" aria-hidden="true">#</a> Pre-requirements for media update</h2><p>First we should make sure that the latest drush version is installed.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> require drush/drush:~10.0 --no-update
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>After that the following steps should be done for the update:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> require drupal/media_entity:^2.0 drupal/media_entity_image drupal/video_embed_field:^2.2
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>Make sure that you use the &quot;Media in core&quot; branch for all your media_* modules. (For the media modules in Thunder, we take care of that)</li><li>Make sure that all your code that uses media_entity API is modified to use the core media API.</li></ul><p>See here for more information:</p>`,30),_={href:"https://www.drupal.org/node/2863992",target:"_blank",rel:"noopener noreferrer"},k=a("Moved a refined version of the contributed Media entity module to core as Media module"),q={href:"https://www.drupal.org/docs/8/core/modules/media/faq-transition-from-media-entity-to-media-in-core#upgrade-instructions-from-media-entity-contrib-to-media-in-core",target:"_blank",rel:"noopener noreferrer"},y=a("FAQ - Transition from Media Entity to Media in core"),x=o(`<h2 id="execute-media-update" tabindex="-1"><a class="header-anchor" href="#execute-media-update" aria-hidden="true">#</a> Execute media update</h2><p>All you need to do now is:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>drush updb
drush cr
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="cleanup-codebase" tabindex="-1"><a class="header-anchor" href="#cleanup-codebase" aria-hidden="true">#</a> Cleanup codebase</h2><p>Now the update is done and you can remove some modules from your project.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> remove drupal/media_entity drupal/media_entity_image
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div>`,6);function w(j,T){const r=t("RouterLink"),s=t("ExternalLinkIcon");return i(),d(l,null,[h,m,e("p",null,[b,n(r,{to:"/developer-guide/setup.html#install-thunder"},{default:u(()=>[g]),_:1}),f]),v,e("ul",null,[e("li",null,[e("a",_,[k,n(s)])]),e("li",null,[e("a",q,[y,n(s)])])]),x],64)}var P=p(c,[["render",w]]);export{P as default};
